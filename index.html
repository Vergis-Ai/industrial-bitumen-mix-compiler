<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMB Bitumen Mix Chart</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 900px;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-slate-100 flex flex-col items-center justify-center p-6">
    <div class="container bg-white rounded-3xl shadow-xl p-8 max-w-lg w-full md:max-w-3xl lg:max-w-4xl">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2 md:text-4xl">PMB Bitumen Mix Chart</h1>
        <p class="text-center text-gray-500 mb-8 max-w-md mx-auto">Enter the percentages of each component to see how the mix's qualities change in real time.</p>

        <!-- Input Fields Section -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-4">
            <!-- Component 1: C170 Bitumen -->
            <div class="bg-gray-50 p-6 rounded-2xl shadow-inner input-group">
                <label for="c170Bitumen" class="text-gray-700 font-medium">C170 Bitumen (%)</label>
                <input type="number" id="c170Bitumen" name="c170Bitumen" min="0" max="100" value="70" class="w-full p-2 rounded-lg border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
            </div>

            <!-- Component 2: LG411 Radial -->
            <div class="bg-gray-50 p-6 rounded-2xl shadow-inner input-group">
                <label for="sbs" class="text-gray-700 font-medium">LG411 Radial (%)</label>
                <input type="number" id="sbs" name="sbs" min="0" max="100" value="15" class="w-full p-2 rounded-lg border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
            </div>

            <!-- Component 3: Ha32 Combining oil -->
            <div class="bg-gray-50 p-6 rounded-2xl shadow-inner input-group">
                <label for="ha32CombiningOil" class="text-gray-700 font-medium">Ha32 Combining Oil (%)</label>
                <input type="number" id="ha32CombiningOil" name="ha32CombiningOil" min="0" max="100" value="10" class="w-full p-2 rounded-lg border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
            </div>

            <!-- Component 4: Bitlinker -->
            <div class="bg-gray-50 p-6 rounded-2xl shadow-inner input-group">
                <label for="bitlinker" class="text-gray-700 font-medium">Ravasol™ BITLINKER-S6F (%)</label>
                <input type="number" id="bitlinker" name="bitlinker" min="0" max="100" value="5" class="w-full p-2 rounded-lg border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
            </div>
        </div>

        <!-- Total Percentage Display -->
        <div class="text-center mb-8 font-bold flex flex-col sm:flex-row items-center justify-center gap-4">
            <span id="totalPercentage" class="text-2xl text-gray-800">Total: 100%</span>
            <span id="remaining" class="text-2xl text-gray-500">Remaining: 0%</span>
            <button id="resetButton" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200">
                Reset to Default
            </button>
        </div>

        <!-- Chart and Qualities Section -->
        <div class="flex flex-col lg:flex-row items-center lg:items-start justify-center gap-8 lg:gap-12">
            <!-- Radar Chart -->
            <div class="w-full lg:w-1/2 p-6 bg-white rounded-3xl shadow-xl flex-shrink-0">
                <canvas id="qualityChart"></canvas>
            </div>

            <!-- Qualities List -->
            <div class="w-full lg:w-1/2 mt-6 lg:mt-0">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center lg:text-left">Mix Qualities</h2>
                <div id="qualitiesList" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <!-- Quality items will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        // Mapping of components to their qualities. Values are relative weights.
        const components = {
            c170Bitumen: {
                name: 'C170 Bitumen',
                qualities: {
                    Adhesion: 0.5,
                    Durability: 0.6,
                    Flexibility: 0.3,
                    TemperatureResistance: 0.4,
                    AgingResistance: 0.5,
                    SettingTime: 0.8,
                    Viscosity: 0.7
                },
                defaultValue: 70
            },
            sbs: {
                name: 'LG411 Radial',
                qualities: {
                    Adhesion: 0.8,
                    Durability: 0.9,
                    Flexibility: 1.0,
                    TemperatureResistance: 0.9,
                    AgingResistance: 0.9,
                    SettingTime: 0.6,
                    Viscosity: 0.9
                },
                defaultValue: 15,
            },
            ha32CombiningOil: {
                name: 'Ha32 Combining Oil',
                qualities: {
                    Adhesion: 0.8,
                    Durability: 0.3,
                    Flexibility: 0.7,
                    TemperatureResistance: 0.5,
                    AgingResistance: 0.7,
                    SettingTime: 1.0,
                    Viscosity: 0.2
                },
                defaultValue: 10,
            },
            bitlinker: {
                name: 'Ravasol™ BITLINKER-S6F',
                qualities: {
                    Adhesion: 0.6,
                    Durability: 0.8,
                    Flexibility: 0.2,
                    TemperatureResistance: 0.9,
                    AgingResistance: 0.9,
                    SettingTime: 0.3,
                    Viscosity: 0.8
                },
                defaultValue: 5,
            }
        };

        const inputIds = ['c170Bitumen', 'sbs', 'ha32CombiningOil', 'bitlinker'];
        let myChart;

        function calculateQualities() {
            const finalQualities = {};
            const qualityKeys = Object.keys(Object.values(components)[0].qualities);
            qualityKeys.forEach(key => finalQualities[key] = 0);

            let totalPercentage = 0;
            for (const inputId of inputIds) {
                const percentage = parseFloat(document.getElementById(inputId).value) || 0;
                totalPercentage += percentage;
            }

            for (const inputId of inputIds) {
                const percentage = parseFloat(document.getElementById(inputId).value) || 0;
                const component = components[inputId];
                for (const quality in component.qualities) {
                    finalQualities[quality] += component.qualities[quality] * percentage / 100;
                }
            }

            const finalValues = {};
            for (const quality in finalQualities) {
                const adjustmentFactor = totalPercentage > 0 ? 100 / totalPercentage : 1;
                finalValues[quality] = Math.round(finalQualities[quality] * adjustmentFactor * 100);
            }
            return finalValues;
        }

        function updateInputs() {
            let total = 0;
            inputIds.forEach(id => {
                const value = parseFloat(document.getElementById(id).value) || 0;
                total += value;
            });
            total = parseFloat(total.toFixed(2));

            document.getElementById('totalPercentage').textContent = `Total: ${total}%`;
            const remaining = parseFloat((100 - total).toFixed(2));
            const remainingElement = document.getElementById('remaining');
            remainingElement.textContent = `Remaining: ${remaining}%`;

            if (remaining === 0) {
                remainingElement.classList.remove('text-red-500');
                remainingElement.classList.add('text-green-500');
            } else {
                remainingElement.classList.remove('text-green-500');
                remainingElement.classList.add('text-red-500');
            }
            updateChart();
        }

        function updateChart() {
            const qualities = calculateQualities();
            myChart.data.datasets[0].data = Object.values(qualities);
            myChart.update();
            updateQualitiesList(qualities);
        }

        function resetToDefault() {
            inputIds.forEach(id => {
                const input = document.getElementById(id);
                input.value = components[id].defaultValue;
            });
            updateInputs();
        }

        function updateQualitiesList(qualities) {
            const listContainer = document.getElementById('qualitiesList');
            listContainer.innerHTML = '';
            for (const quality in qualities) {
                const item = document.createElement('div');
                item.className = 'bg-gray-100 p-4 rounded-xl shadow-sm flex items-center justify-between transition-all duration-300 transform hover:scale-105';
                const qualityName = document.createElement('span');
                qualityName.className = 'text-gray-700 font-semibold';
                qualityName.textContent = quality.replace(/([A-Z])/g, ' $1').trim();
                const qualityValue = document.createElement('span');
                qualityValue.className = 'text-lg font-bold text-indigo-600';
                qualityValue.textContent = qualities[quality] + '%';
                item.appendChild(qualityName);
                item.appendChild(qualityValue);
                listContainer.appendChild(item);
            }
        }

        window.onload = function () {
            const ctx = document.getElementById('qualityChart').getContext('2d');
            const qualities = calculateQualities();
            const dataValues = Object.values(qualities);
            const qualityLabels = Object.keys(qualities).map(label => label.replace(/([A-Z])/g, ' $1').trim());

            myChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: qualityLabels,
                    datasets: [{
                        label: 'Mix Qualities',
                        data: dataValues,
                        backgroundColor: 'rgba(99, 102, 241, 0.4)',
                        borderColor: 'rgb(99, 102, 241)',
                        pointBackgroundColor: 'rgb(99, 102, 241)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(99, 102, 241)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: {
                                font: { size: 12, weight: 'bold' },
                                color: '#4b5563'
                            },
                            ticks: {
                                beginAtZero: true,
                                max: 100,
                                stepSize: 20,
                                backdropColor: 'transparent',
                                color: '#6b7280'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.r !== null) {
                                        label += context.parsed.r + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
            
            inputIds.forEach(id => {
                const input = document.getElementById(id);
                input.addEventListener('input', updateInputs);
            });

            document.getElementById('resetButton').addEventListener('click', resetToDefault);

            window.addEventListener('resize', () => {
                myChart.resize();
            });
            
            updateInputs();
        };
    </script>
</body>
</html>
